{"ast":null,"code":"import _slicedToArray from\"/home/runner/work/blackjack-gto/blackjack-gto/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import\"styles/Card.scss\";import{connect}from\"react-redux\";import ConstantsFE from\"utils/constants/ConstantsFE\";import{addDealerAnimationCompletedAction,addPlayerAnimationCompletedAction}from\"actions/animationActions\";import{bindActionCreators}from\"redux\";import AnimationService from\"services/AnimationService\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Card=function Card(props){var table=props.table,card=props.card,_props$isPlaying=props.isPlaying,isPlaying=_props$isPlaying===void 0?true:_props$isPlaying,id=props.id,dealerAnimations=props.dealerAnimations,playerAnimations=props.playerAnimations,animationsEnabled=props.animationsEnabled,cardIndex=props.cardIndex,addDealerAnimationCompleted=props.addDealerAnimationCompleted,addPlayerAnimationCompleted=props.addPlayerAnimationCompleted;var _useState=useState(),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),suit=_useState4[0],setSuit=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),rotate=_useState6[0],setRotate=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),display=_useState8[0],setDisplay=_useState8[1];var setDisplayRotateAndCount;useEffect(function(){setValue(card===null||card===void 0?void 0:card.value);setSuit(card===null||card===void 0?void 0:card.suit);},[card]);useEffect(function(){if(!table)return;if(!animationsEnabled){setDisplay(true);return;}if(table.tableState===ConstantsFE.T_STATE_END){setDisplay(false);}else if(table.tableState===ConstantsFE.T_STATE_DEALER){AnimationService.setAnimations(table);}},[table,animationsEnabled]);// handle animations for initial deal of two cards to player(s)/dealer\nuseEffect(function(){if(!animationsEnabled)return;if(table.tableState!==ConstantsFE.T_STATE_PLAYING)return;if(id===ConstantsFE.DEALER_ID){if(!dealerAnimations)return;var delay=dealerAnimations[cardIndex+1];setDisplayRotateAndCount(delay,true);}else{if(!playerAnimations)return;var _delay=playerAnimations[id][cardIndex];setDisplayRotateAndCount(_delay,false);}},[dealerAnimations,playerAnimations,animationsEnabled,cardIndex,id,setDisplayRotateAndCount,table.tableState]);// handle animations for dealing dealer\nuseEffect(function(){if(table.tableState!==ConstantsFE.T_STATE_DEALER||id!==ConstantsFE.DEALER_ID||!animationsEnabled)return;// debugger;\nvar delay=dealerAnimations[cardIndex];setDisplayRotateAndCount(delay,true);},[dealerAnimations,animationsEnabled,cardIndex,id,setDisplayRotateAndCount,table.tableState]);setDisplayRotateAndCount=function setDisplayRotateAndCount(delay,isDealer){setTimeout(function(){setDisplay(true);},delay-200);setTimeout(function(){if(isDealer){addDealerAnimationCompleted();}else{addPlayerAnimationCompleted(id);}setRotate(true);},delay);};var suitSymbol={c:{symbol:\"♣\",color:\"black\"},s:{symbol:\"♠\",color:\"black\"},d:{symbol:\"♦\",color:\"red\"},h:{symbol:\"♥\",color:\"red\"}};var faceCards={11:\"J\",12:\"Q\",13:\"K\",14:\"A\"};var getValueAndSuit=function getValueAndSuit(){var selectedSuit=suitSymbol[suit];return/*#__PURE__*/_jsxs(\"div\",{className:(selectedSuit===null||selectedSuit===void 0?void 0:selectedSuit.color)===\"red\"?\"text-red\":\"\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-text\",children:faceCards[value]?faceCards[value]:value}),/*#__PURE__*/_jsx(\"div\",{className:\"card-text\",children:selectedSuit===null||selectedSuit===void 0?void 0:selectedSuit.symbol})]});};return isPlaying?/*#__PURE__*/_jsx(\"div\",{className:\"card card-animation \".concat(rotate?\"begin-rotation\":\"\",\" \").concat(!display?\"display-none\":\"\"),style:{transition:\"all 0.5s ease\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-animation-container\",children:[animationsEnabled&&/*#__PURE__*/_jsx(\"div\",{className:\"card-back card-hidden\"}),/*#__PURE__*/_jsxs(\"div\",{className:animationsEnabled?\"card-front\":\"card-back\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"top-left\",children:getValueAndSuit()}),/*#__PURE__*/_jsx(\"div\",{className:\"suit-bottom-right\",children:getValueAndSuit()})]})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"card card-hidden \".concat(!display?\"display-none\":\"\")});};var mapStateToProps=function mapStateToProps(state){var _state$table,_state$animations,_state$animations2,_state$animations3;return{table:(_state$table=state.table)===null||_state$table===void 0?void 0:_state$table.table,dealerAnimations:(_state$animations=state.animations)===null||_state$animations===void 0?void 0:_state$animations.dealerAnimations,playerAnimations:(_state$animations2=state.animations)===null||_state$animations2===void 0?void 0:_state$animations2.playerAnimations,animationsEnabled:(_state$animations3=state.animations)===null||_state$animations3===void 0?void 0:_state$animations3.animationsEnabled};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({addDealerAnimationCompleted:addDealerAnimationCompletedAction,addPlayerAnimationCompleted:addPlayerAnimationCompletedAction},dispatch);};export default connect(mapStateToProps,mapDispatchToProps)(Card);","map":{"version":3,"names":["useEffect","useState","connect","ConstantsFE","addDealerAnimationCompletedAction","addPlayerAnimationCompletedAction","bindActionCreators","AnimationService","Card","props","table","card","isPlaying","id","dealerAnimations","playerAnimations","animationsEnabled","cardIndex","addDealerAnimationCompleted","addPlayerAnimationCompleted","value","setValue","suit","setSuit","rotate","setRotate","display","setDisplay","setDisplayRotateAndCount","tableState","T_STATE_END","T_STATE_DEALER","setAnimations","T_STATE_PLAYING","DEALER_ID","delay","isDealer","setTimeout","suitSymbol","c","symbol","color","s","d","h","faceCards","getValueAndSuit","selectedSuit","transition","mapStateToProps","state","animations","mapDispatchToProps","dispatch"],"sources":["/home/runner/work/blackjack-gto/blackjack-gto/client/src/components/players/Card.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport \"styles/Card.scss\";\n\nimport { connect } from \"react-redux\";\nimport ConstantsFE from \"utils/constants/ConstantsFE\";\nimport {\n  addDealerAnimationCompletedAction,\n  addPlayerAnimationCompletedAction\n} from \"actions/animationActions\";\nimport { bindActionCreators } from \"redux\";\nimport AnimationService from \"services/AnimationService\";\n\nconst Card = (props) => {\n  const {\n    table,\n    card,\n    isPlaying = true,\n    id,\n    dealerAnimations,\n    playerAnimations,\n    animationsEnabled,\n    cardIndex, // when initially dealing,\n    //dealer hidden card = -1, regular dealer card = index - 1\n    addDealerAnimationCompleted,\n    addPlayerAnimationCompleted\n  } = props;\n  const [value, setValue] = useState();\n  const [suit, setSuit] = useState();\n  const [rotate, setRotate] = useState(false);\n  const [display, setDisplay] = useState(false);\n  let setDisplayRotateAndCount;\n\n  useEffect(() => {\n    setValue(card?.value);\n    setSuit(card?.suit);\n  }, [card]);\n\n  useEffect(() => {\n    if (!table) return;\n    if (!animationsEnabled) {\n      setDisplay(true);\n      return;\n    }\n    if (table.tableState === ConstantsFE.T_STATE_END) {\n      setDisplay(false);\n    } else if (table.tableState === ConstantsFE.T_STATE_DEALER) {\n      AnimationService.setAnimations(table);\n    }\n  }, [table, animationsEnabled]);\n\n  // handle animations for initial deal of two cards to player(s)/dealer\n  useEffect(() => {\n    if (!animationsEnabled) return;\n    if (table.tableState !== ConstantsFE.T_STATE_PLAYING) return;\n    if (id === ConstantsFE.DEALER_ID) {\n      if (!dealerAnimations) return;\n      let delay = dealerAnimations[cardIndex + 1];\n      setDisplayRotateAndCount(delay, true);\n    } else {\n      if (!playerAnimations) return;\n      let delay = playerAnimations[id][cardIndex];\n      setDisplayRotateAndCount(delay, false);\n    }\n  }, [\n    dealerAnimations,\n    playerAnimations,\n    animationsEnabled,\n    cardIndex,\n    id,\n    setDisplayRotateAndCount,\n    table.tableState\n  ]);\n\n  // handle animations for dealing dealer\n  useEffect(() => {\n    if (\n      table.tableState !== ConstantsFE.T_STATE_DEALER ||\n      id !== ConstantsFE.DEALER_ID ||\n      !animationsEnabled\n    )\n      return;\n    // debugger;\n    let delay = dealerAnimations[cardIndex];\n    setDisplayRotateAndCount(delay, true);\n  }, [\n    dealerAnimations,\n    animationsEnabled,\n    cardIndex,\n    id,\n    setDisplayRotateAndCount,\n    table.tableState\n  ]);\n\n  setDisplayRotateAndCount = (delay, isDealer) => {\n    setTimeout(() => {\n      setDisplay(true);\n    }, delay - 200);\n    setTimeout(() => {\n      if (isDealer) {\n        addDealerAnimationCompleted();\n      } else {\n        addPlayerAnimationCompleted(id);\n      }\n      setRotate(true);\n    }, delay);\n  };\n\n  const suitSymbol = {\n    c: { symbol: \"♣\", color: \"black\" },\n    s: { symbol: \"♠\", color: \"black\" },\n    d: { symbol: \"♦\", color: \"red\" },\n    h: { symbol: \"♥\", color: \"red\" }\n  };\n\n  const faceCards = {\n    11: \"J\",\n    12: \"Q\",\n    13: \"K\",\n    14: \"A\"\n  };\n\n  const getValueAndSuit = () => {\n    let selectedSuit = suitSymbol[suit];\n\n    return (\n      <div className={selectedSuit?.color === \"red\" ? \"text-red\" : \"\"}>\n        <div className=\"card-text\">\n          {faceCards[value] ? faceCards[value] : value}\n        </div>\n        <div className=\"card-text\">{selectedSuit?.symbol}</div>\n      </div>\n    );\n  };\n\n  return isPlaying ? (\n    <div\n      className={`card card-animation ${rotate ? \"begin-rotation\" : \"\"} ${\n        !display ? \"display-none\" : \"\"\n      }`}\n      style={{ transition: \"all 0.5s ease\" }}\n    >\n      <div className=\"card-animation-container\">\n        {animationsEnabled && <div className=\"card-back card-hidden\"></div>}\n\n        <div className={animationsEnabled ? \"card-front\" : \"card-back\"}>\n          <div className=\"top-left\">{getValueAndSuit()}</div>\n          <div className=\"suit-bottom-right\">{getValueAndSuit()}</div>\n        </div>\n      </div>\n    </div>\n  ) : (\n    <div className={`card card-hidden ${!display ? \"display-none\" : \"\"}`}></div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    table: state.table?.table,\n    dealerAnimations: state.animations?.dealerAnimations,\n    playerAnimations: state.animations?.playerAnimations,\n    animationsEnabled: state.animations?.animationsEnabled\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return bindActionCreators(\n    {\n      addDealerAnimationCompleted: addDealerAnimationCompletedAction,\n      addPlayerAnimationCompleted: addPlayerAnimationCompletedAction\n    },\n    dispatch\n  );\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Card);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}