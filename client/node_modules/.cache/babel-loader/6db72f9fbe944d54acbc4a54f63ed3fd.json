{"ast":null,"code":"import React from\"react\";import\"../styles/Table.scss\";import Dealer from\"components/players/Dealer\";import Player from\"components/players/Player\";import NavBar from\"./NavBar\";import MiddleInfo from\"./middleInfo/MiddleInfo\";import SettingsDrawer from\"./SettingsDrawer\";import TableLogo from\"./TableLogo\";import BasicStrategy from\"./basicStrategy/BasicStrategy\";import ActionServiceFE from\"../services/ActionServiceFE\";import TableStateServiceFE from\"../services/TableStateServiceFE\";import KeydownService from\"../services/KeyDownService\";import AnimationService from\"../services/AnimationService\";import{resetDealerAnimationCompletedAction,resetPlayerAnimationCompletedAction}from\"../actions/animationActions\";import{updateNumPlayersAction,updateDealingDelayAction,setIdAction}from\"../actions/tableActions\";import{bindActionCreators}from\"redux\";import{connect}from\"react-redux\";import{useEffect}from\"react\";import{v4 as uuidv4}from\"uuid\";import ConstantsFE from\"../utils/constants/ConstantsFE\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Table(props){var table=props.table,updateNumPlayers=props.updateNumPlayers,updateDealingDelay=props.updateDealingDelay,setId=props.setId,dealerAnimationCompleted=props.dealerAnimationCompleted,animationsEnabled=props.animationsEnabled;useEffect(function(){var numPlayers=1;var id=uuidv4();setId(id);updateNumPlayers(numPlayers);updateDealingDelay(1000);ActionServiceFE.initTable(numPlayers);},[updateNumPlayers,updateDealingDelay,setId]);useEffect(function(){if(process.env.NODE_ENV===\"development\"){console.log(\"table\",table);}if(!table)return;if(table.tableState===ConstantsFE.T_STATE_PLAYING){AnimationService.resetAnimations(table);AnimationService.setAnimations(table);}else if(table.tableState===ConstantsFE.T_STATE_DEALER&&table.tableStateService.resetDealerAnimation){AnimationService.resetDealerAnimations();AnimationService.setDealerAnimations(table);}},[table]);useEffect(function(){if(!table)return;if(!animationsEnabled||table.tableState!==ConstantsFE.T_STATE_DEALER){TableStateServiceFE.determineNextAction(table);}// wait until all animations compelte before making next dealer req\nelse{var animationCompleted=table.dealer.shouldShowAllCards?dealerAnimationCompleted:dealerAnimationCompleted-1;if(table.dealer.shownCards.length===animationCompleted){TableStateServiceFE.determineNextAction(table);}}},[table,dealerAnimationCompleted,animationsEnabled]);useEffect(function(){document.addEventListener(\"keydown\",KeydownService.handleKeyDown);window.screen.orientation.lock(\"landscape\");return function(){document.removeEventListener(\"keydown\",KeydownService.handleKeyDown);window.screen.orientation.unlock();};},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table table-felt\",children:[/*#__PURE__*/_jsx(TableLogo,{}),/*#__PURE__*/_jsx(\"div\",{className:\"inner-table\",children:\"\\xA0\"})]}),/*#__PURE__*/_jsx(BasicStrategy,{}),/*#__PURE__*/_jsx(SettingsDrawer,{}),/*#__PURE__*/_jsx(NavBar,{}),/*#__PURE__*/_jsx(Dealer,{}),/*#__PURE__*/_jsx(MiddleInfo,{}),/*#__PURE__*/_jsx(Player,{})]});}var mapStateToProps=function mapStateToProps(state){var _state$table,_state$animations,_state$animations2;return{table:(_state$table=state.table)===null||_state$table===void 0?void 0:_state$table.table,dealerAnimationCompleted:(_state$animations=state.animations)===null||_state$animations===void 0?void 0:_state$animations.dealerAnimationCompleted,animationsEnabled:(_state$animations2=state.animations)===null||_state$animations2===void 0?void 0:_state$animations2.animationsEnabled};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return bindActionCreators({updateNumPlayers:updateNumPlayersAction,updateDealingDelay:updateDealingDelayAction,setId:setIdAction,resetDealerAnimationCompleted:resetDealerAnimationCompletedAction,resetPlayerAnimationCompleted:resetPlayerAnimationCompletedAction},dispatch);};export default connect(mapStateToProps,mapDispatchToProps)(Table);","map":{"version":3,"names":["React","Dealer","Player","NavBar","MiddleInfo","SettingsDrawer","TableLogo","BasicStrategy","ActionServiceFE","TableStateServiceFE","KeydownService","AnimationService","resetDealerAnimationCompletedAction","resetPlayerAnimationCompletedAction","updateNumPlayersAction","updateDealingDelayAction","setIdAction","bindActionCreators","connect","useEffect","v4","uuidv4","ConstantsFE","Table","props","table","updateNumPlayers","updateDealingDelay","setId","dealerAnimationCompleted","animationsEnabled","numPlayers","id","initTable","process","env","NODE_ENV","console","log","tableState","T_STATE_PLAYING","resetAnimations","setAnimations","T_STATE_DEALER","tableStateService","resetDealerAnimation","resetDealerAnimations","setDealerAnimations","determineNextAction","animationCompleted","dealer","shouldShowAllCards","shownCards","length","document","addEventListener","handleKeyDown","window","screen","orientation","lock","removeEventListener","unlock","mapStateToProps","state","animations","mapDispatchToProps","dispatch","resetDealerAnimationCompleted","resetPlayerAnimationCompleted"],"sources":["/home/runner/work/blackjack-gto/blackjack-gto/client/src/components/Table.js"],"sourcesContent":["import React from \"react\";\nimport \"../styles/Table.scss\";\nimport Dealer from \"components/players/Dealer\";\nimport Player from \"components/players/Player\";\nimport NavBar from \"./NavBar\";\nimport MiddleInfo from \"./middleInfo/MiddleInfo\";\nimport SettingsDrawer from \"./SettingsDrawer\";\nimport TableLogo from \"./TableLogo\";\nimport BasicStrategy from \"./basicStrategy/BasicStrategy\";\n\nimport ActionServiceFE from \"../services/ActionServiceFE\";\nimport TableStateServiceFE from \"../services/TableStateServiceFE\";\nimport KeydownService from \"../services/KeyDownService\";\nimport AnimationService from \"../services/AnimationService\";\nimport {\n  resetDealerAnimationCompletedAction,\n  resetPlayerAnimationCompletedAction\n} from \"../actions/animationActions\";\n\nimport {\n  updateNumPlayersAction,\n  updateDealingDelayAction,\n  setIdAction\n} from \"../actions/tableActions\";\n\nimport { bindActionCreators } from \"redux\";\nimport { connect } from \"react-redux\";\nimport { useEffect } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport ConstantsFE from \"../utils/constants/ConstantsFE\";\n\nfunction Table(props) {\n  const {\n    table,\n    updateNumPlayers,\n    updateDealingDelay,\n    setId,\n    dealerAnimationCompleted,\n    animationsEnabled\n  } = props;\n\n  useEffect(() => {\n    let numPlayers = 1;\n    let id = uuidv4();\n    setId(id);\n    updateNumPlayers(numPlayers);\n    updateDealingDelay(1000);\n    ActionServiceFE.initTable(numPlayers);\n  }, [updateNumPlayers, updateDealingDelay, setId]);\n\n  useEffect(() => {\n    if (process.env.NODE_ENV === \"development\") {\n      console.log(\"table\", table);\n    }\n    if (!table) return;\n    if (table.tableState === ConstantsFE.T_STATE_PLAYING) {\n      AnimationService.resetAnimations(table);\n      AnimationService.setAnimations(table);\n    } else if (\n      table.tableState === ConstantsFE.T_STATE_DEALER &&\n      table.tableStateService.resetDealerAnimation\n    ) {\n      AnimationService.resetDealerAnimations();\n      AnimationService.setDealerAnimations(table);\n    }\n  }, [table]);\n\n  useEffect(() => {\n    if (!table) return;\n    if (!animationsEnabled || table.tableState !== ConstantsFE.T_STATE_DEALER) {\n      TableStateServiceFE.determineNextAction(table);\n    }\n    // wait until all animations compelte before making next dealer req\n    else {\n      let animationCompleted = table.dealer.shouldShowAllCards\n        ? dealerAnimationCompleted\n        : dealerAnimationCompleted - 1;\n      if (table.dealer.shownCards.length === animationCompleted) {\n        TableStateServiceFE.determineNextAction(table);\n      }\n    }\n  }, [table, dealerAnimationCompleted, animationsEnabled]);\n\n  useEffect(() => {\n    document.addEventListener(\"keydown\", KeydownService.handleKeyDown);\n    window.screen.orientation.lock(\"landscape\");\n    return () => {\n      document.removeEventListener(\"keydown\", KeydownService.handleKeyDown);\n      window.screen.orientation.unlock();\n    };\n  }, []);\n\n  return (\n    <div>\n      <div className=\"table table-felt\">\n        <TableLogo></TableLogo>\n        <div className=\"inner-table\">&nbsp;</div>\n      </div>\n      <BasicStrategy></BasicStrategy>\n      <SettingsDrawer></SettingsDrawer>\n      <NavBar></NavBar>\n      <Dealer></Dealer>\n      <MiddleInfo></MiddleInfo>\n      <Player></Player>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    table: state.table?.table,\n    dealerAnimationCompleted: state.animations?.dealerAnimationCompleted,\n    animationsEnabled: state.animations?.animationsEnabled\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return bindActionCreators(\n    {\n      updateNumPlayers: updateNumPlayersAction,\n      updateDealingDelay: updateDealingDelayAction,\n      setId: setIdAction,\n      resetDealerAnimationCompleted: resetDealerAnimationCompletedAction,\n      resetPlayerAnimationCompleted: resetPlayerAnimationCompletedAction\n    },\n    dispatch\n  );\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Table);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}