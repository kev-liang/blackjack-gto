{"ast":null,"code":"import _classCallCheck from\"/home/runner/work/blackjack-gto/blackjack-gto/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/runner/work/blackjack-gto/blackjack-gto/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";import{setDealerAnimationsAction,setPlayerIdAnimationAction,resetDealerAnimationCompletedAction,resetPlayerAnimationCompletedAction}from\"../actions/animationActions\";import{store}from\"../store\";var AnimationService=/*#__PURE__*/function(){function AnimationService(){_classCallCheck(this,AnimationService);this.animationDelay=700;this.count=0;this.doneDealingDealer=true;this.doneDealingPlayers=true;}_createClass(AnimationService,[{key:\"resetAnimations\",value:function resetAnimations(table){table.players.forEach(function(player){store.dispatch(resetPlayerAnimationCompletedAction(player.id));store.dispatch(setPlayerIdAnimationAction(player.id,[]));});this.count=0;}},{key:\"resetDealerAnimations\",value:function resetDealerAnimations(){store.dispatch(resetDealerAnimationCompletedAction());store.dispatch(setDealerAnimationsAction([]));this.count=0;}},{key:\"setAnimations\",value:function setAnimations(table){this.doneDealingDealer=false;this.doneDealingPlayers=false;while(!this.doneDealingDealer||!this.doneDealingPlayers){var animations=store.getState().animations||{};this.handlePlayerAnimation(table,animations.playerAnimations);this.handleDealerAnimation(table,animations.dealerAnimations);}}},{key:\"handlePlayerAnimation\",value:function handlePlayerAnimation(table,playerAnimations){var _this=this;var numPlayersFullyDealt=0;table.players.forEach(function(player){var animations=playerAnimations&&playerAnimations[player.id]?playerAnimations[player.id]:[];if(player.cards.length>animations.length){_this.count+=_this.animationDelay;animations.push(_this.count);store.dispatch(setPlayerIdAnimationAction(player.id,animations));}else{numPlayersFullyDealt++;}});if(numPlayersFullyDealt===table.players.length){this.doneDealingPlayers=true;}}},{key:\"handleDealerAnimation\",value:function handleDealerAnimation(table,dealerAnimations){var includeDealerInitialCard=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var animations=dealerAnimations?dealerAnimations:[];var shownCards=table.dealer.shownCards;var numShownCards=includeDealerInitialCard?shownCards.length+1:shownCards.length;var numToDeal=numShownCards-animations.length;if(numToDeal>0){this.count+=this.animationDelay;animations.push(this.count);store.dispatch(setDealerAnimationsAction(animations));}else{this.doneDealingDealer=true;}}},{key:\"setDealerAnimations\",value:function setDealerAnimations(table){this.doneDealingDealer=false;var animations=store.getState().animations||{};while(!this.doneDealingDealer){this.handleDealerAnimation(table,animations.dealerAnimations,false);}}}]);return AnimationService;}();export default new AnimationService();","map":{"version":3,"names":["setDealerAnimationsAction","setPlayerIdAnimationAction","resetDealerAnimationCompletedAction","resetPlayerAnimationCompletedAction","store","AnimationService","animationDelay","count","doneDealingDealer","doneDealingPlayers","table","players","forEach","player","dispatch","id","animations","getState","handlePlayerAnimation","playerAnimations","handleDealerAnimation","dealerAnimations","numPlayersFullyDealt","cards","length","push","includeDealerInitialCard","shownCards","dealer","numShownCards","numToDeal"],"sources":["/home/runner/work/blackjack-gto/blackjack-gto/client/src/services/AnimationService.js"],"sourcesContent":["import {\n  setDealerAnimationsAction,\n  setPlayerIdAnimationAction,\n  resetDealerAnimationCompletedAction,\n  resetPlayerAnimationCompletedAction\n} from \"../actions/animationActions\";\n\nimport { store } from \"../store\";\n\nclass AnimationService {\n  constructor() {\n    this.animationDelay = 700;\n    this.count = 0;\n    this.doneDealingDealer = true;\n    this.doneDealingPlayers = true;\n  }\n\n  resetAnimations(table) {\n    table.players.forEach((player) => {\n      store.dispatch(resetPlayerAnimationCompletedAction(player.id));\n      store.dispatch(setPlayerIdAnimationAction(player.id, []));\n    });\n    this.count = 0;\n  }\n\n  resetDealerAnimations() {\n    store.dispatch(resetDealerAnimationCompletedAction());\n    store.dispatch(setDealerAnimationsAction([]));\n    this.count = 0;\n  }\n\n  setAnimations(table) {\n    this.doneDealingDealer = false;\n    this.doneDealingPlayers = false;\n    while (!this.doneDealingDealer || !this.doneDealingPlayers) {\n      let animations = store.getState().animations || {};\n      this.handlePlayerAnimation(table, animations.playerAnimations);\n      this.handleDealerAnimation(table, animations.dealerAnimations);\n    }\n  }\n\n  handlePlayerAnimation(table, playerAnimations) {\n    let numPlayersFullyDealt = 0;\n    table.players.forEach((player) => {\n      let animations =\n        playerAnimations && playerAnimations[player.id]\n          ? playerAnimations[player.id]\n          : [];\n      if (player.cards.length > animations.length) {\n        this.count += this.animationDelay;\n        animations.push(this.count);\n        store.dispatch(setPlayerIdAnimationAction(player.id, animations));\n      } else {\n        numPlayersFullyDealt++;\n      }\n    });\n    if (numPlayersFullyDealt === table.players.length) {\n      this.doneDealingPlayers = true;\n    }\n  }\n\n  handleDealerAnimation(\n    table,\n    dealerAnimations,\n    includeDealerInitialCard = true\n  ) {\n    let animations = dealerAnimations ? dealerAnimations : [];\n    let { shownCards } = table.dealer;\n    let numShownCards = includeDealerInitialCard\n      ? shownCards.length + 1\n      : shownCards.length;\n    let numToDeal = numShownCards - animations.length;\n    if (numToDeal > 0) {\n      this.count += this.animationDelay;\n      animations.push(this.count);\n      store.dispatch(setDealerAnimationsAction(animations));\n    } else {\n      this.doneDealingDealer = true;\n    }\n  }\n\n  setDealerAnimations(table) {\n    this.doneDealingDealer = false;\n    let animations = store.getState().animations || {};\n    while (!this.doneDealingDealer) {\n      this.handleDealerAnimation(table, animations.dealerAnimations, false);\n    }\n  }\n}\n\nexport default new AnimationService();\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}